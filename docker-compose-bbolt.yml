version: '3.4'
services:
  bitcoind:
    image: kylemanna/bitcoind
    volumes:
      - ./bitcoin.conf:/bitcoin/.bitcoin/bitcoin.conf

  lnd-alice-1:
    restart: unless-stopped
    image: lightninglabs/lnd:v0.12.1-beta
    depends_on:
      - bitcoind
    volumes:
      - ./lnd.conf:/root/.lnd/lnd.conf
      - lnd-alice-1:/cfg
    command: --tlsextradomain=lnd-alice-1

  lnd-bob-1:
    restart: unless-stopped
    image: lightninglabs/lnd:v0.12.1-beta
    depends_on:
      - bitcoind
    volumes:
      - ./lnd.conf:/root/.lnd/lnd.conf
      - lnd-bob-1:/cfg
    command: --tlsextradomain=lnd-bob-1

  lnd-alice-2:
    restart: unless-stopped
    image: lightninglabs/lnd:v0.12.1-beta
    depends_on:
      - bitcoind
    volumes:
      - ./lnd.conf:/root/.lnd/lnd.conf
      - lnd-alice-2:/cfg
    command: --tlsextradomain=lnd-alice-2

  lnd-bob-2:
    restart: unless-stopped
    image: lightninglabs/lnd:v0.12.1-beta
    depends_on:
      - bitcoind
    volumes:
      - ./lnd.conf:/root/.lnd/lnd.conf
      - lnd-bob-2:/cfg
    command: --tlsextradomain=lnd-bob-2

  loadtest:
    build: loadtest
    volumes:
      - lnd-alice-1:/lnd-alice-1
      - lnd-bob-1:/lnd-bob-1
      - lnd-alice-2:/lnd-alice-2
      - lnd-bob-2:/lnd-bob-2
      - ./${LOADTEST_CONFIG_FILE}:/loadtest.yml

volumes:
  lnd-alice-1:
  lnd-bob-1:
  lnd-alice-2:
  lnd-bob-2:
